# Git Reset 三种模式完全指南

## 📚 核心概念理解

在理解 `git reset` 的三种模式之前，我们需要先理解Git的三个重要区域：

```
工作区(Working Directory) → 暂存区(Staging Area) → 本地仓库(Repository)
       ↓                         ↓                      ↓
   实际文件内容              git add 后的内容         git commit 后的内容
```

### Git的三个区域详解

1. **工作区 (Working Directory)**
   - 你实际看到和编辑的文件
   - 使用编辑器修改的内容都在这里

2. **暂存区 (Staging Area/Index)**
   - 使用 `git add` 后文件存放的地方
   - 准备提交的内容

3. **本地仓库 (Repository)**
   - 使用 `git commit` 后永久保存的内容
   - Git历史记录存储的地方

---

## 🔧 Git Reset 三种模式对比

| 模式 | 命令 | 影响区域 | 工作区 | 暂存区 | 仓库 |
|------|------|----------|--------|--------|------|
| **--soft** | `git reset --soft <commit>` | 仅仓库 | 保持不变 | 保持不变 | 回退 ✅ |
| **--mixed** | `git reset --mixed <commit>` | 仓库+暂存区 | 保持不变 | 清空 ✅ | 回退 ✅ |
| **--hard** | `git reset --hard <commit>` | 全部 | 清空 ✅ | 清空 ✅ | 回退 ✅ |

---

## 🎭 模式详解与应用场景

### 1. --soft (软重置) ⭐⭐

**作用：只移动HEAD指针，不影响工作区和暂存区**

```bash
git reset --soft <commit>
```

**效果：**
- ✅ HEAD指针移动到指定提交
- ✅ 工作区文件内容不变
- ✅ 暂存区内容不变
- ✅ 之前的提交变成"未提交"状态

**适用场景：**
- 撤销最近的提交，但保留所有修改
- 重新组织提交历史
- 修改提交信息
- 合并多个小提交

### 2. --mixed (混合重置) ⭐⭐⭐ 默认模式

**作用：移动HEAD指针 + 清空暂存区**

```bash
git reset --mixed <commit>
# 或者简写
git reset <commit>
```

**效果：**
- ✅ HEAD指针移动到指定提交
- ✅ 工作区文件内容不变
- ❌ 暂存区被清空
- ✅ 修改变成"未暂存"状态

**适用场景：**
- 撤销提交和暂存操作
- 重新选择要提交的文件
- 取消 `git add` 操作
- 重新组织暂存内容

### 3. --hard (硬重置) ⚠️ 危险操作

**作用：完全回退到指定状态**

```bash
git reset --hard <commit>
```

**效果：**
- ✅ HEAD指针移动到指定提交
- ❌ 工作区被完全清空并恢复到指定提交状态
- ❌ 暂存区被清空
- ❌ 所有未提交的修改丢失

**适用场景：**
- 完全放弃当前所有修改
- 紧急回退到稳定版本
- 清理工作区到特定状态
- 生产环境紧急回滚

---

## 🎪 实际演示案例

接下来我们将通过实际操作来演示这三种模式的区别。我们会创建一个演示项目，添加多个提交，然后分别测试三种reset模式。

### 演示步骤预览

1. **创建演示仓库**
2. **添加多个提交** (A → B → C)
3. **分别演示三种reset模式的效果**
4. **对比结果差异**

---

## 📊 选择指南

### 根据需求选择reset模式

#### 🤔 "我想撤销提交，但保留所有修改"
→ 使用 `git reset --soft HEAD~1`

#### 🤔 "我想撤销提交和add操作，但保留文件修改"
→ 使用 `git reset --mixed HEAD~1` (或 `git reset HEAD~1`)

#### 🤔 "我想完全回到之前的状态，丢弃所有修改"
→ 使用 `git reset --hard HEAD~1`

#### 🤔 "我只想撤销git add操作"
→ 使用 `git reset HEAD <file>` 或 `git reset`

---

## ⚠️ 重要注意事项

### 1. 数据安全
- `--soft` 和 `--mixed` 不会丢失工作区修改
- `--hard` 会永久删除未提交的修改
- 使用 `--hard` 前一定要确认

### 2. 协作影响
- reset操作只影响本地仓库
- 如果已经push到远程，需要谨慎处理
- 团队协作时避免重写已共享的历史

### 3. 恢复可能性
- reset后的提交在一段时间内可以通过reflog恢复
- `git reflog` 可以查看操作历史
- `git reset --hard <reflog-hash>` 可以恢复

---

## 🚀 下一步：实际演示

准备好了吗？我们现在开始实际演示这三种模式的区别！

**演示内容：**
1. 创建测试仓库和文件
2. 制造多个提交状态
3. 逐一演示三种reset模式
4. 观察和对比结果差异
